@using Microsoft.AspNetCore.Http
@{
    ViewData["Title"] = "Danh s√°ch B√°o c√°o";
    var user = Context.Session.GetString("User");
    var primaryGreen = "#428446";
    var lightGreen = "#e8f9e8";
}

<div class="container-fluid mt-3" style="font-family:'Segoe UI', sans-serif;">

    <div class="d-flex justify-content-between align-items-center p-3 rounded shadow-sm"
         style="background-color:@primaryGreen; color:white;">
        <h4 class="fw-semibold m-0">üìä Danh s√°ch B√°o c√°o</h4>
        <div class="fw-semibold">
            Xin ch√†o, @(user ?? "Ng∆∞·ªùi d√πng")
        </div>
    </div>

    <div class="card shadow-sm border-0 my-4">
        <div class="card-body">
            <div class="row g-3 align-items-end">
                <div class="col-md-3">
                    <label class="form-label fw-semibold" style="color:@primaryGreen;">Lo·∫°i b√°o c√°o</label>
                    <select class="form-select border-success">
                        <option>T·∫•t c·∫£</option>
                        <option>B√°o c√°o doanh thu</option>
                        <option>B√°o c√°o t·ªìn kho</option>
                        <option>B√°o c√°o c√¥ng n·ª£</option>
                        <option>B√°o c√°o b√°n h√†ng</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-semibold" style="color:@primaryGreen;">T·ª´ ng√†y</label>
                    <input type="date" class="form-control border-success">
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-semibold" style="color:@primaryGreen;">ƒê·∫øn ng√†y</label>
                    <input type="date" class="form-control border-success">
                </div>
                <div class="col-md-3 text-end">
                    <button class="btn fw-semibold text-white px-4"
                            style="background-color:@primaryGreen;">üîç Tra c·ª©u</button>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        
        <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header fw-semibold" style="background-color:@lightGreen; color:@primaryGreen;">
                    Ph√¢n b·ªï theo Lo·∫°i b√°o c√°o
                </div>
                <div class="card-body">
                    <canvas id="chartLoaiBaoCao" height="200"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header fw-semibold" style="background-color:@lightGreen; color:@primaryGreen;">
                    Th·ªëng k√™ theo Tr·∫°ng th√°i
                </div>
                <div class="card-body">
                    <canvas id="chartTrangThai" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-header fw-semibold text-white"
             style="background-color:@primaryGreen;">Danh s√°ch b√°o c√°o g·∫ßn ƒë√¢y</div>
        <div class="card-body p-0">
            <table class="table table-hover align-middle mb-0">
                <thead style="background-color:#cde9cd; color:#1f421f;">
                    <tr>
                        <th>#</th>
                        <th>T√™n b√°o c√°o</th>
                        <th>Lo·∫°i</th>
                        <th>Ng√†y t·∫°o</th>
                        <th>Ng∆∞·ªùi l·∫≠p</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th class="text-center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>B√°o c√°o doanh thu th√°ng 10</td>
                        <td>Doanh thu</td>
                        <td>01/11/2025</td>
                        <td>Nguy·ªÖn VƒÉn C</td>
                        <td><span class="badge bg-success">Ho√†n t·∫•t</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm text-white" style="background-color:@primaryGreen;">üìÑ Xem</button>
                            <button class="btn btn-sm btn-outline-success">‚¨á T·∫£i</button>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>B√°o c√°o t·ªìn kho qu√Ω IV</td>
                        <td>T·ªìn kho</td>
                        <td>28/10/2025</td>
                        <td>Tr·∫ßn Th·ªã B</td>
                        <td><span class="badge bg-warning text-dark">ƒêang x·ª≠ l√Ω</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm text-white" style="background-color:@primaryGreen;">üìÑ Xem</button>
                            <button class="btn btn-sm btn-outline-success">‚¨á T·∫£i</button>
                        </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>B√°o c√°o b√°n h√†ng tu·∫ßn 43</td>
                        <td>B√°n h√†ng</td>
                        <td>25/10/2025</td>
                        <td>Ph·∫°m Minh D</td>
                        <td><span class="badge bg-success">Ho√†n t·∫•t</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm text-white" style="background-color:@primaryGreen;">üìÑ Xem</button>
                            <button class="btn btn-sm btn-outline-success">‚¨á T·∫£i</button>
                        </td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>B√°o c√°o c√¥ng n·ª£ kh√°ch h√†ng Q4</td>
                        <td>C√¥ng n·ª£</td>
                        <td>20/10/2025</td>
                        <td>Nguy·ªÖn VƒÉn C</td>
                        <td><span class="badge bg-info text-dark">ƒê√£ g·ª≠i</span></td>
                        <td class="text-center">
                            <button class="btn btn-sm text-white" style="background-color:@primaryGreen;">üìÑ Xem</button>
                            <button class="btn btn-sm btn-outline-success">‚¨á T·∫£i</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- BI·ªÇU ƒê·ªí 1: PH√ÇN B·ªî LO·∫†I B√ÅO C√ÅO (DOUGHNUT CHART) ---
            const ctxLoai = document.getElementById('chartLoaiBaoCao').getContext('2d');
            new Chart(ctxLoai, {
                type: 'doughnut',
                data: {
                    labels: ['Doanh thu', 'T·ªìn kho', 'C√¥ng n·ª£', 'B√°n h√†ng'],
                    datasets: [{
                        data: [45, 25, 15, 15], // D·ªØ li·ªáu gi·∫£ ƒë·ªãnh
                        backgroundColor: [
                            '#428446', // Primary Green
                            '#007bff', // Blue (T·ªìn kho)
                            '#ffc107', // Yellow (C√¥ng n·ª£)
                            '#dc3545'  // Red (B√°n h√†ng)
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'T·ªïng s·ªë b√°o c√°o: 100' // T·ªïng gi·∫£ ƒë·ªãnh
                        }
                    }
                }
            });

            // --- BI·ªÇU ƒê·ªí 2: TH·ªêNG K√ä TR·∫†NG TH√ÅI (BAR CHART) ---
            const ctxTrangThai = document.getElementById('chartTrangThai').getContext('2d');
            new Chart(ctxTrangThai, {
                type: 'bar',
                data: {
                    labels: ['Ho√†n t·∫•t', 'ƒêang x·ª≠ l√Ω', 'ƒê√£ g·ª≠i'],
                    datasets: [{
                        label: 'S·ªë l∆∞·ª£ng b√°o c√°o',
                        data: [70, 20, 10], // D·ªØ li·ªáu gi·∫£ ƒë·ªãnh
                        backgroundColor: [
                            '#28a745', // Success (Ho√†n t·∫•t)
                            '#ffc107', // Warning (ƒêang x·ª≠ l√Ω)
                            '#17a2b8'  // Info (ƒê√£ g·ª≠i)
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'S·ªë l∆∞·ª£ng'
                            }
                        },
                        x: {
                            grid: {
                                display: false 
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        });
    </script>
}