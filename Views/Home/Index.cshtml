﻿@using Microsoft.AspNetCore.Http
@{
    ViewData["Title"] = "Tổng quan Kho hàng";
    
    // MÀU SẮC CHỦ ĐẠO ADMINLTE CHUYÊN NGHIỆP:
    var primaryColorAdminLTE = "#28a745"; 
    var successColor = "#28a745";
    var infoColor = "#17a2b8";
    var warningColor = "#ffc107";
    var dangerColor = "#dc3545";
    
    // Giả lập dữ liệu Tỉ lệ (Sẽ được thay thế bằng Model/ViewData)
    var tiLeLechKho = "0.5%";
    var tiLeNhapVsXuat = "120%"; 
    var hangDuoiDinhMuc = "8.2%"; 
    var tiLeChiếmDụngKho = "75%"; 
}

<div class="content-header">
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center p-3 rounded shadow-sm"
             style="background-color: @primaryColorAdminLTE; color: white;">
            <h4 class="m-0 font-weight-bold"><i class="fas fa-warehouse mr-2"></i> Tổng quan Kho hàng & Tồn kho</h4>
            <span>Chi nhánh: <strong>Kho Tổng</strong></span>
        </div>
    </div>
</div>

<section class="content">
    <div class="container-fluid">
        
        <div class="row mt-3">
            <div class="col-lg-3 col-6">
                <div class="small-box bg-white border-left border-info shadow-sm" style="border-left-width: 5px !important;">
                    <div class="inner">
                        <h3 class="text-info">@tiLeLechKho</h3>
                        <p>Tỷ lệ Lệch kho (Kiểm kê)</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-balance-scale text-info" style="opacity: 0.3"></i>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-6">
                <div class="small-box bg-white border-left border-success shadow-sm" style="border-left-width: 5px !important;">
                    <div class="inner">
                        <h3 class="text-success">@tiLeNhapVsXuat</h3>
                        <p>Tỷ lệ Nhập / Xuất (Theo Giá trị)</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-exchange-alt text-success" style="opacity: 0.3"></i>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-6">
                <div class="small-box bg-white border-left border-warning shadow-sm" style="border-left-width: 5px !important;">
                    <div class="inner">
                        <h3 class="text-warning">@hangDuoiDinhMuc</h3>
                        <p>Tỷ lệ SKU dưới Định mức tối thiểu</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-exclamation-triangle text-warning" style="opacity: 0.3"></i>
                    </div>
                </div>
            </div>
            
            
            <div class="col-lg-3 col-6">
                <div class="small-box bg-white border-left border-primary shadow-sm" style="border-left-width: 5px !important;">
                    <div class="inner">
                        <h3 class="text-primary">@tiLeChiếmDụngKho</h3>
                        <p>Tỷ lệ Vị trí/Kệ đang chứa hàng</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-truck-box text-primary" style="opacity: 0.3"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-9">
                <div class="card card-primary card-outline"> 
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-chart-pie mr-1"></i> Cơ cấu Tồn kho theo Nhóm hàng (%)</h3>
                    </div>
                    <div class="card-body">
                        <div class="chart">
                            <canvas id="chartCoCauTonKho" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                        </div>
                        <div class="text-center mt-3 text-muted">
                            <p>Sẽ hiển thị biểu đồ tròn phân bổ Tồn kho theo Nhóm hàng khi Scripts được kích hoạt.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card card-primary card-outline"> 
                    <div class="card-header bg-light">
                        <h3 class="card-title text-primary"><i class="fas fa-clock mr-1"></i> Giao dịch gần nhất</h3>
                    </div>
                    <div class="card-body p-0">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <span class="text-success font-weight-bold">PHIẾU XUẤT #PX008</span> vừa được tạo<br>
                                <b>12,060,000 ₫</b> <small class="text-muted float-right">4h trước</small>
                            </li>
                            <li class="list-group-item">
                                <span class="text-primary font-weight-bold">PHIẾU NHẬP #PN001</span> vừa được nhập<br>
                                <b>15,090,000 ₫</b> <small class="text-muted float-right">6h trước</small>
                            </li>
                             <li class="list-group-item">
                                <span class="text-success font-weight-bold">PHIẾU XUẤT #PX007</span> vừa được tạo<br>
                                <b>5,000,000 ₫</b> <small class="text-muted float-right">7h trước</small>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card card-outline card-primary"> 
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-hourglass-start mr-1"></i> Báo cáo: Hàng hóa tồn kho lâu nhất</h3>
                    </div>
                    <div class="card-body">
                        <table id="topProductsTable" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Mã hàng</th>
                                    <th>Tên hàng hóa</th>
                                    <th>Vị trí/Lô</th>
                                    <th>Ngày nhập kho</th> 
                                    <th>Số lượng tồn</th>
                                    <th>Thời gian tồn (Ngày)</th> 
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>SP001</td><td>Bình Super Chillwee</td><td>Khu A-01</td><td>20/10/2023</td><td class="text-success font-weight-bold">464</td><td>40</td></tr>
                                <tr><td>DV002</td><td>Tiền công sửa chữa</td><td>N/A</td><td>N/A</td><td class="text-success font-weight-bold">0</td><td>N/A</td></tr>
                                <tr><td>VC003</td><td>VOUCHER - 500K</td><td>Khu C-05</td><td>01/11/2023</td><td class="text-success font-weight-bold">84</td><td>29</td></tr>
                                <tr><td>MBH01</td><td>NÓN BẢO HIỂM EBIKE</td><td>Khu A-02</td><td>10/11/2023</td><td class="text-success font-weight-bold">23</td><td>20</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
}